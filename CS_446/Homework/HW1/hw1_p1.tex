\documentclass[11pt]{article}

\usepackage{homeworkpkg}
\usepackage{bm}
\linespread{1.2}

%% Local Macros and packages: add any of your own definitions here.

\begin{document}

% Homework number, your name and NetID, and optionally, the names/NetIDs of anyone you collaborated with. If you did not collaborate with anybody, leave the last parameter empty.
\homework
    {1}
    {Yiming Gao (yimingg2)}
    {}

\begin{center}
      \Large\textbf{Multivariate Poisson Naive Bayes}\\
\end{center}

\section*{Problem 1}
\textbf{Solution:} 
\[P(y = A) = \frac{3}{7},\ P(y=B) = \frac{4}{7}\]

Using MLE to compute $\lambda$'s: 
\begin{align*}
&P(x_1 = x|y = A)= \frac{e^{-\lambda^A_1}(\lambda^A_1)^x}{x!} \\[0.8em]
\Longrightarrow &P(D_n| y = A) = \prod_{i=1}^{3} P(x_1 = x|y = A) = \frac{e^{-3\lambda^A_1}(\lambda^A_1)^{\sum x_{1i}}}{x_{11}!\cdot ...\cdot x_{13}!}\\[0.8em]
\Longrightarrow &logP(D_n| y = A) = -3\lambda^A_1 + \sum x_{1i}log(\lambda^A_1)-log(\prod x_{1i}!)\\[0.8em]
\Longrightarrow &\frac{\partial logP(D_n| y = A)}{\partial \lambda^A_1} = -3 + \frac{\sum x_{1i}}{\lambda^A_1}\\[0.8em]
\Longrightarrow & \lambda^A_1 = \frac{\sum x_{1i}}{3} = \frac{1+5+3}{3} = 3
\end{align*}

Similarly, $\lambda^B_1 = 5, \ \lambda^A_2 = 6, \ \lambda^B_2 = 4$.

\section*{Problem 2}
\textbf{Solution:} 

We have 
\[P[x_1 = x|y = A] = \frac{e^{-3}\cdot 3^x}{x!},\ 
P[x_1 = x|y = B] = \frac{e^{-5}\cdot 5^x}{x!},\]
\[P[x_2 = x|y = A] = \frac{e^{-6}\cdot 6^x}{x!},\ 
P[x_2 = x|y = B] = \frac{e^{-4}\cdot 4^x}{x!}\]

Then
\[P[x_1 = 2|y = A] = 0.61, \ P[x_2 = 3|y = A] = 0.09\]
\[P[x_1 = 2|y = B] = 0.08, \ P[x_2 = 3|y = B] = 0.20\]
Thus, $$\frac{P(x_1 = 2, x_2 = 3|y = A)}{P(x_1 = 2, x_2 = 3|y = B)} = \frac{0.61\times 0.09}{0.08\times 0.20} = 3.43$$.


\section*{Problem 3}
Derive an algebraic expression for the Poisson Naive Bayes predictior for Y in terms of the parameters estimated from the data.

\textbf{Solution:} 

\begin{align*}
P(y = A|x_1, x_2) &= \frac{P(y=A)\cdot P(x_1, x_2|y = A)}{P(x_1, x_2)}\\[0.8em]
& \propto P(y=A)\cdot P(x_1|y = A)\cdot P(x_2|y = A) \\[0.8em]
& \propto \frac{3}{7}\frac{e^{-3}\cdot 3^{x_1}}{x_1!}\cdot \frac{e^{-6}\cdot 6^{x_2}}{x_2!}
\end{align*}
Similarly,
\begin{align*}
P(y = B|x_1, x_2) &= \frac{P(y=B)\cdot P(x_1, x_2|y = B)}{P(x_1, x_2)}\\[0.8em]
& \propto P(y=B)\cdot P(x_1|y = B)\cdot P(x_2|y = B) \\[0.8em]
& \propto \frac{4}{7}\frac{e^{-6}\cdot 6^{x_1}}{x_1!}\cdot \frac{e^{-4}\cdot 4^{x_2}}{x_2!}
\end{align*}


\section*{Problem 4}
\textbf{Solution:} 

For $\bm{x} = [x_1, x_2] = [2,3]$, we have $$P(\bm{x}|y = A) = 0.024 > P(\bm{x}|y = B) = 0.009,$$ So we have $y_{pred} = A$.




\newpage \nocite{*}
\bibliographystyle{ims}
\bibliography{citations}

\end{document}
